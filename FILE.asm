FILEWORD MACRO DATA1
    MOV BX,OFFSET DATA1
    SUB CH,CH
    MOV CL,[BX]+1
    MOV WORDS,CX 
    ENDM
    
PRINT MACRO DATA2
    MOV AH,09H
    MOV DX,OFFSET DATA2
    INT 21H
    ENDM

DATAS SEGMENT
    ;此处输入数据段代码
     ORG 0010H
MESSAGE DB 'PLEASE ENTER THE NAME OF FILE:',CR,LF,'$'
MESSAGE2 DB CR,LF,'PLEASE ENTER THE CONTENT:',CR,LF,'$'   
ADDRESS DB 10,?,10 DUP(00)
LONG    DB ?
BUF     DB 100,?,100 DUP(00)
EMESSAGE DB 0AH,'ERROR!','$'
SMESSAGE DB 0AH,'SUCCESS!','$'
HANDLE DW ?
WORDS  DW ?
CR EQU 0DH
LF EQU 0AH
DATAS ENDS

STACKS SEGMENT
    ;此处输入堆栈段代码
STACKS ENDS

CODES SEGMENT
    ASSUME CS:CODES,DS:DATAS,SS:STACKS
START:
MAIN PROC FAR
    MOV AX,DATAS
    MOV DS,AX
    ;此处输入代码段代码
   
    ;输入文件标题
    PRINT MESSAGE
    MOV AH,0AH
    MOV DX,OFFSET ADDRESS
    INT 21H
    
    ;将输入缓冲区中的0DH换为00H
    FILEWORD ADDRESS
    SUB CH,CH
    MOV SI,CX
    MOV BYTE PTR[BX+SI]+2,00
    
    ;获取文件名到00处结束，新建文件
    MOV DX,OFFSET ADDRESS
    INC DX
    INC DX
    MOV CX,0
    MOV AH,3CH
    INT 21H
    JC ERROR
    MOV HANDLE,AX
    
    ;输入文件内容
    PRINT MESSAGE2
    MOV AH,0AH
    MOV DX,OFFSET BUF
    INT 21H
    
    ;获取输入内容字数
    FILEWORD BUF
    MOV BX,HANDLE
    MOV CX,WORDS
    MOV DX,OFFSET BUF
    INC DX
    INC DX
    MOV AH,40H
    INT 21H
    JC ERROR
    
    ;关闭文件
    MOV BX,HANDLE
    MOV AH,3EH
    INT 21H
    JC ERROR
    PRINT SMESSAGE
    JMP END1
ERROR:
    PRINT EMESSAGE
END1:
    MOV AH,4CH
    INT 21H
    
MAIN ENDP
   
CODES ENDS
    END START


